<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started • tbeploads</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tbeploads</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/tbeploads.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tbep-tech/tbeploads/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tbep-tech/tbeploads/blob/main/vignettes/tbeploads.Rmd" class="external-link"><code>vignettes/tbeploads.Rmd</code></a></small>
      <div class="d-none name"><code>tbeploads.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the package from <a href="http://tbep-tech.r-universe.dev/ui/#builds" class="external-link">r-universe</a> as
follows. The source code is available on <a href="https://github.com/tbep-tech/tbeploads" class="external-link">GitHub</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install tbeploads in R:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'tbeploads'</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'https://tbep-tech.r-universe.dev'</span>, <span class="st">'https://cloud.r-project.org'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Load the package in an R session after installation:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tbeploads</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Load estimates are broadly defined as domestic point source (DPS),
industrial point source (IPS), material losses (ML), nonpoint source
(NPS), atmospheric deposition (AD), and groundwater sources and springs
(GW). The functions are built around these sources with unique inputs
for each.</p>
<div class="section level3">
<h3 id="dps">DPS<a class="anchor" aria-label="anchor" href="#dps"></a>
</h3>
<p>The domestic point source (DPS) functions are designed to work with
raw entity data provided by partners. The core function is
<code><a href="../reference/anlz_dps_facility.html">anlz_dps_facility()</a></code> that requires only a vector of file
paths as input, where each path points to a file with monthly parameter
concentration (mg/L) and flow data (million gallons per day). The data
also describe whether the observations are end of pipe (direct inflow to
the bay) or reuse (applied to the land), with each defined by outfall
Ids typically noted as D-001, D-002, etc. and R-001, R-002, etc,
respectively. Both are estimated as concentration times flow, whereas
reuse includes an attenuation factor for land application depending on
location. The file names must follow a specific convention, where
metadata for each entity is found in the <code><a href="../reference/facilities.html">facilities()</a></code> data
object using information in the file name.</p>
<p>For convenience, four example files are included with the package.
These files represent actual entities and facilities, but the data have
been randomized. The paths to these files are used as input to the
function. Non-trivial data pre-processing and quality control is needed
for each file and those included in the package are the correct format.
The output is returned as tons per month for TN, TP, TSS, and BOD and
million cubic meters per month for flow (hy).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dpsfls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">'ps_dom'</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/anlz_dps_facility.html">anlz_dps_facility</a></span><span class="op">(</span><span class="va">dpsfls</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 144 × 11</span></span></span>
<span><span class="co">#&gt;     Year Month entity  facility coastco source tn_load tp_load tss_load bod_load</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>021     1 Clearw… City of… 387     D-001    0.862  6.04     0.452     1.14 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>021     2 Clearw… City of… 387     D-001    1.37   1.15     0.553     2.87 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>021     3 Clearw… City of… 387     D-001    1.70   0.575    0.982     3.31 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>021     4 Clearw… City of… 387     D-001    0.344  0.080<span style="text-decoration: underline;">1</span>   0.105     0.656</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>021     5 Clearw… City of… 387     D-001    1.09   0.460    0.603     2.23 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>021     6 Clearw… City of… 387     D-001    0.641  0.435    0.248     0.588</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>021     7 Clearw… City of… 387     D-001    0.667  0.183    0.360     1.33 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>021     8 Clearw… City of… 387     D-001    0.138  0.164    0.060<span style="text-decoration: underline;">1</span>    0.327</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>021     9 Clearw… City of… 387     D-001    0.421  1.63     0.281     0.655</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>021    10 Clearw… City of… 387     D-001    1.15   0.217    0.563     0.666</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 134 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: hy_load &lt;dbl&gt;</span></span></span></code></pre></div>
<p>The <code><a href="../reference/anlz_dps.html">anlz_dps()</a></code> function uses
<code><a href="../reference/anlz_dps_facility.html">anlz_dps_facility()</a></code> to summarize the DPS results by
location as facility (combines outfall data), entity (combines facility
data), bay segment (combines entity data), and as all (combines bay
segment data). The results can also be temporally summarized as monthly
or annual totals. The location summary is defined by the
<code>summ</code> argument and the temporal summary is defined by the
<code>summtime</code> argument. The <code>fls</code> argument used by
<code><a href="../reference/anlz_dps_facility.html">anlz_dps_facility()</a></code> is also used by
<code><a href="../reference/anlz_dps.html">anlz_dps()</a></code>. The output is tons per month for TN, TP, TSS,
and BOD and as million cubic meters per month for flow (hy) if
<code>summtime = 'month'</code> or tons per year for TN, TP, TSS, and
BOD and million cubic meters per year for flow (hy) if
<code>summtime = 'year'</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># combine by entity and month</span></span>
<span><span class="fu"><a href="../reference/anlz_dps.html">anlz_dps</a></span><span class="op">(</span><span class="va">dpsfls</span>, summ <span class="op">=</span> <span class="st">'entity'</span>, summtime <span class="op">=</span> <span class="st">'month'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 108 × 10</span></span></span>
<span><span class="co">#&gt;     Year Month source   entity segment tn_load tp_load tss_load bod_load hy_load</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>021     1 DPS - e… Clear… Old Ta…  0.862  6.04     0.452    1.14     0.663 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>021     1 DPS - r… Clear… Old Ta…  0.102  0.008<span style="text-decoration: underline;">52</span>  0.008<span style="text-decoration: underline;">44</span>  0.047<span style="text-decoration: underline;">3</span>   0.165 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>021     2 DPS - e… Clear… Old Ta…  1.37   1.15     0.553    2.87     0.948 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>021     2 DPS - r… Clear… Old Ta…  0.210  0.041<span style="text-decoration: underline;">6</span>   0.016<span style="text-decoration: underline;">9</span>   0.024<span style="text-decoration: underline;">4</span>   0.319 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>021     3 DPS - e… Clear… Old Ta…  1.70   0.575    0.982    3.31     1.83  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>021     3 DPS - r… Clear… Old Ta…  0.261  0.043<span style="text-decoration: underline;">9</span>   0.019<span style="text-decoration: underline;">4</span>   0.055<span style="text-decoration: underline;">4</span>   0.417 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>021     4 DPS - e… Clear… Old Ta…  0.344  0.080<span style="text-decoration: underline;">1</span>   0.105    0.656    0.194 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>021     4 DPS - r… Clear… Old Ta…  0.047<span style="text-decoration: underline;">2</span> 0.006<span style="text-decoration: underline;">02</span>  0.002<span style="text-decoration: underline;">45</span>  0.004<span style="text-decoration: underline;">99</span>  0.056<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>021     5 DPS - e… Clear… Old Ta…  1.09   0.460    0.603    2.23     0.874 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>021     5 DPS - r… Clear… Old Ta…  0.035<span style="text-decoration: underline;">4</span> 0.002<span style="text-decoration: underline;">81</span>  0.002<span style="text-decoration: underline;">98</span>  0.008<span style="text-decoration: underline;">85</span>  0.072<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 98 more rows</span></span></span>
<span></span>
<span><span class="co"># combine by bay segment and year</span></span>
<span><span class="fu"><a href="../reference/anlz_dps.html">anlz_dps</a></span><span class="op">(</span><span class="va">dpsfls</span>, summ <span class="op">=</span> <span class="st">"segment"</span>, summtime <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 8</span></span></span>
<span><span class="co">#&gt;    Year source            segment      tn_load tp_load tss_load bod_load hy_load</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>017 DPS - end of pipe Hillsboroug…   0.891 1.20<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>  2.90<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>  6.92<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span> 5.25<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>017 DPS - reuse       Hillsboroug… 464.    2.94<span style="color: #949494;">e</span>+1  5.10<span style="color: #949494;">e</span>+1  1.70<span style="color: #949494;">e</span>+2 1.10<span style="color: #949494;">e</span>+3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">2</span>018 DPS - end of pipe Hillsboroug… 102.    1.49<span style="color: #949494;">e</span>+1  3.58<span style="color: #949494;">e</span>+1  8.24<span style="color: #949494;">e</span>+1 6.43<span style="color: #949494;">e</span>+1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">2</span>018 DPS - reuse       Hillsboroug…  28.6   8.80<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>  1.82<span style="color: #949494;">e</span>+0  4.88<span style="color: #949494;">e</span>+0 3.95<span style="color: #949494;">e</span>+1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">2</span>019 DPS - end of pipe Hillsboroug…  14.4   1.63<span style="color: #949494;">e</span>+0  2.92<span style="color: #949494;">e</span>+0  9.17<span style="color: #949494;">e</span>+0 6.55<span style="color: #949494;">e</span>+0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">2</span>019 DPS - reuse       Hillsboroug…   4.21  8.47<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span>  1.33<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>  5.20<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span> 3.82<span style="color: #949494;">e</span>+0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>  <span style="text-decoration: underline;">2</span>021 DPS - reuse       Hillsboroug…   2.90  1.61<span style="color: #949494;">e</span><span style="color: #BB0000;">-9</span>  1.61<span style="color: #949494;">e</span><span style="color: #BB0000;">-9</span>  1.61<span style="color: #949494;">e</span><span style="color: #BB0000;">-9</span> 1.76<span style="color: #949494;">e</span>+0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>  <span style="text-decoration: underline;">2</span>021 DPS - end of pipe Old Tampa B…   8.62  1.11<span style="color: #949494;">e</span>+1  4.34<span style="color: #949494;">e</span>+0  1.43<span style="color: #949494;">e</span>+1 7.35<span style="color: #949494;">e</span>+0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span>  <span style="text-decoration: underline;">2</span>021 DPS - reuse       Old Tampa B…   1.48  2.35<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>  1.19<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>  7.17<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span> 2.39<span style="color: #949494;">e</span>+0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ips">IPS<a class="anchor" aria-label="anchor" href="#ips"></a>
</h3>
<p>The industrial point source (IPS) functions are designed to work with
raw entity data provided by partners and are similar in functionality to
the DPS functions. The core function is <code><a href="../reference/anlz_ips_facility.html">anlz_ips_facility()</a></code>
that requires only a vector of file paths as input, where each path
points to a file with monthly parameter concentration (mg/L) and flow
data (million gallons per day). Loads are estimated as concentration
times flow. The file names must follow a specific convention, where
metadata for each entity is found in the <code><a href="../reference/facilities.html">facilities()</a></code> data
object using information in the file name.</p>
<p>For convenience, four example files are included with the package.
These files represent actual entities and facilities, but the data have
been randomized. The paths to these files are used as input to the
function. As before, non-trivial data pre-processing and quality control
is needed for each file and those included in the package are the
correct format. The output is returned as tons per month for TN, TP,
TSS, and BOD and million cubic meters per month for flow (hy).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ipsfls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">'ps_ind_'</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/anlz_ips_facility.html">anlz_ips_facility</a></span><span class="op">(</span><span class="va">ipsfls</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 60 × 11</span></span></span>
<span><span class="co">#&gt;     Year Month entity  facility coastco source tn_load tp_load tss_load bod_load</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>020     1 Busch … Busch G… 191a    D-002   0.019<span style="text-decoration: underline;">5</span> 0.002<span style="text-decoration: underline;">53</span>    0.443    0.850</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>020     2 Busch … Busch G… 191a    D-002   0.030<span style="text-decoration: underline;">6</span> 0.003<span style="text-decoration: underline;">28</span>    0.544    1.04 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>020     3 Busch … Busch G… 191a    D-002   0.097<span style="text-decoration: underline;">2</span> 0.009<span style="text-decoration: underline;">25</span>    1.39     2.68 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>020     4 Busch … Busch G… 191a    D-002   0.039<span style="text-decoration: underline;">8</span> 0.025<span style="text-decoration: underline;">8</span>     0.522    1.00 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>020     5 Busch … Busch G… 191a    D-002   0.082<span style="text-decoration: underline;">0</span> 0.005<span style="text-decoration: underline;">14</span>    0.506    0.971</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>020     6 Busch … Busch G… 191a    D-002   0.011<span style="text-decoration: underline;">2</span> 0.005<span style="text-decoration: underline;">94</span>    0.355    0.681</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>020     7 Busch … Busch G… 191a    D-002   0.043<span style="text-decoration: underline;">0</span> 0.004<span style="text-decoration: underline;">13</span>    0.506    0.971</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>020     8 Busch … Busch G… 191a    D-002   0.016<span style="text-decoration: underline;">7</span> 0.002<span style="text-decoration: underline;">25</span>    0.199    0.382</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>020     9 Busch … Busch G… 191a    D-002   0.022<span style="text-decoration: underline;">6</span> 0.003<span style="text-decoration: underline;">07</span>    0.332    0.638</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>020    10 Busch … Busch G… 191a    D-002   0.018<span style="text-decoration: underline;">7</span> 0.018<span style="text-decoration: underline;">6</span>     0.333    0.638</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 50 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: hy_load &lt;dbl&gt;</span></span></span></code></pre></div>
<p>The <code><a href="../reference/anlz_ips.html">anlz_ips()</a></code> function uses
<code><a href="../reference/anlz_ips_facility.html">anlz_ips_facility()</a></code> to summarize the IPS results by
location as facility (combines outfall data), entity (combines facility
data), bay segment (combines entity data), and as all (combines bay
segment data). The results can also be temporally summarized as monthly
or annual totals. The location summary is defined by the
<code>summ</code> argument and the temporal summary is defined by the
<code>summtime</code> argument. The <code>fls</code> argument used by
<code><a href="../reference/anlz_ips_facility.html">anlz_ips_facility()</a></code> is also used by
<code><a href="../reference/anlz_ips.html">anlz_ips()</a></code>. The output is tons per month for TN, TP, TSS,
and BOD and as million cubic meters per month for flow (hy) if
<code>summtime = 'month'</code> or tons per year for TN, TP, TSS, and
BOD and million cubic meters per year for flow (hy) if
<code>summtime = 'year'</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># combine by entity and month</span></span>
<span><span class="fu"><a href="../reference/anlz_ips.html">anlz_ips</a></span><span class="op">(</span><span class="va">ipsfls</span>, summ <span class="op">=</span> <span class="st">'entity'</span>, summtime <span class="op">=</span> <span class="st">'month'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 60 × 10</span></span></span>
<span><span class="co">#&gt;     Year Month source entity   segment tn_load tp_load tss_load bod_load hy_load</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>020     1 IPS    Busch G… Hillsb…  0.019<span style="text-decoration: underline;">5</span> 0.002<span style="text-decoration: underline;">53</span>    0.443    0.850  0.080<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>020     2 IPS    Busch G… Hillsb…  0.030<span style="text-decoration: underline;">6</span> 0.003<span style="text-decoration: underline;">28</span>    0.544    1.04   0.098<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>020     3 IPS    Busch G… Hillsb…  0.097<span style="text-decoration: underline;">2</span> 0.009<span style="text-decoration: underline;">25</span>    1.39     2.68   0.253 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>020     4 IPS    Busch G… Hillsb…  0.039<span style="text-decoration: underline;">8</span> 0.025<span style="text-decoration: underline;">8</span>     0.522    1.00   0.094<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>020     5 IPS    Busch G… Hillsb…  0.082<span style="text-decoration: underline;">0</span> 0.005<span style="text-decoration: underline;">14</span>    0.506    0.971  0.091<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>020     6 IPS    Busch G… Hillsb…  0.011<span style="text-decoration: underline;">2</span> 0.005<span style="text-decoration: underline;">94</span>    0.355    0.681  0.064<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>020     7 IPS    Busch G… Hillsb…  0.043<span style="text-decoration: underline;">0</span> 0.004<span style="text-decoration: underline;">13</span>    0.506    0.971  0.091<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>020     8 IPS    Busch G… Hillsb…  0.016<span style="text-decoration: underline;">7</span> 0.002<span style="text-decoration: underline;">25</span>    0.199    0.382  0.036<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>020     9 IPS    Busch G… Hillsb…  0.022<span style="text-decoration: underline;">6</span> 0.003<span style="text-decoration: underline;">07</span>    0.332    0.638  0.060<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>020    10 IPS    Busch G… Hillsb…  0.018<span style="text-decoration: underline;">7</span> 0.018<span style="text-decoration: underline;">6</span>     0.333    0.638  0.060<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 50 more rows</span></span></span>
<span></span>
<span><span class="co"># combine by bay segment and year</span></span>
<span><span class="fu"><a href="../reference/anlz_ips.html">anlz_ips</a></span><span class="op">(</span><span class="va">ipsfls</span>, summ <span class="op">=</span> <span class="st">"segment"</span>, summtime <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 8</span></span></span>
<span><span class="co">#&gt;    Year source segment          tn_load tp_load tss_load bod_load hy_load</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>017 IPS    Hillsborough Bay  0.215   0.061<span style="text-decoration: underline;">2</span>   0           0    0.188 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>018 IPS    Hillsborough Bay  0.168   0.045<span style="text-decoration: underline;">6</span>   0           0    0.140 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">2</span>019 IPS    Hillsborough Bay  0.095<span style="text-decoration: underline;">0</span>  0.022<span style="text-decoration: underline;">6</span>   0           0    0.076<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">2</span>020 IPS    Hillsborough Bay  0.437   0.085<span style="text-decoration: underline;">8</span>   6.11       11.7  1.11  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">2</span>021 IPS    Hillsborough Bay  0.030<span style="text-decoration: underline;">5</span>  0.051<span style="text-decoration: underline;">5</span>   0.066<span style="text-decoration: underline;">2</span>      0    0.018<span style="text-decoration: underline;">4</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ml">ML<a class="anchor" aria-label="anchor" href="#ml"></a>
</h3>
<p>Material losses (ML) are estimates of nutrient loads to the bay
primarily from fertilizer shipping activities at ports. Historically,
loadings from material losses were much higher than at present. Only a
few entities report material losses, typically as a total for the year
and only for total nitrogen. The material losses as tons/yr are
estimated from the tons shipped using an agreed upon loss rate. Values
reported in the example files represent the estimated loss as the total
tons of N shipped each year multiplied by 0.0023 and divided by 2000.
The total N shipped at a facility each year can be obtained using a
simple back-calculation (multiply by 2000, divide by 0.0023).</p>
<p>The core function is <code><a href="../reference/anlz_ml_facility.html">anlz_ml_facility()</a></code> that requires
only a vector of file paths as input, where each file should be one row
per year per facility, where the row shows the total tons per year of
total nitrogen loss. The file names must follow a specific convention,
where metadata for each entity is found in the <code><a href="../reference/facilities.html">facilities()</a></code>
data object using information in the file name.</p>
<p>For convenience, four example files are included with the package.
These files represent actual entities and facilities, but the data have
been randomized. The paths to these files are used as input to the
function. The output is nearly identical to the input data since no load
calculations are used, except results are shown as monthly load as the
annual loss divided by 12. Additional empty columns (e.g., TP load, TSS
load, etc.) are also returned for consistency of reporting with other
loading sources.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mlfls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">'ps_indml'</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/anlz_ml_facility.html">anlz_ml_facility</a></span><span class="op">(</span><span class="va">mlfls</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 60 × 11</span></span></span>
<span><span class="co">#&gt;     Year Month entity  facility coastco source tn_load tp_load tss_load bod_load</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>017     1 Kinder… Kinder … <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      0.015<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>017     2 Kinder… Kinder … <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      0.015<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>017     3 Kinder… Kinder … <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      0.015<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>017     4 Kinder… Kinder … <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      0.015<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>017     5 Kinder… Kinder … <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      0.015<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>017     6 Kinder… Kinder … <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      0.015<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>017     7 Kinder… Kinder … <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      0.015<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>017     8 Kinder… Kinder … <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      0.015<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>017     9 Kinder… Kinder … <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      0.015<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>017    10 Kinder… Kinder … <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      0.015<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 50 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: hy_load &lt;lgl&gt;</span></span></span></code></pre></div>
<p>The <code><a href="../reference/anlz_ml.html">anlz_ml()</a></code> function uses
<code><a href="../reference/anlz_ml_facility.html">anlz_ml_facility()</a></code> to summarize the IPS results by location
as facility, entity (combines facility data), bay segment (combines
entity data), and as all (combines bay segment data). The results can
also be temporally summarized as monthly or annual totals. The location
summary is defined by the <code>summ</code> argument and the temporal
summary is defined by the <code>summtime</code> argument. The
<code>fls</code> argument used by <code><a href="../reference/anlz_ml_facility.html">anlz_ml_facility()</a></code> is
also used by <code><a href="../reference/anlz_ml.html">anlz_ml()</a></code>. The output is tons per month of TN
if <code>summtime = 'month'</code> or tons per year of TN if
<code>summtime = 'year'</code>. Columns for TP, TSS, BOD, and hydrologic
load are also returned with zero load for consistency with other point
source load calculation functions. Material loss loads are often
combined with IPS loads for reporting.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># combine by entity and month</span></span>
<span><span class="fu"><a href="../reference/anlz_ml.html">anlz_ml</a></span><span class="op">(</span><span class="va">mlfls</span>, summ <span class="op">=</span> <span class="st">'entity'</span>, summtime <span class="op">=</span> <span class="st">'month'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 60 × 10</span></span></span>
<span><span class="co">#&gt;     Year Month source entity segment   tn_load tp_load tss_load bod_load hy_load</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>020     1 ML     CSX    Hillsbor…  0.074<span style="text-decoration: underline;">3</span>       0        0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>020     2 ML     CSX    Hillsbor…  0.074<span style="text-decoration: underline;">3</span>       0        0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>020     3 ML     CSX    Hillsbor…  0.074<span style="text-decoration: underline;">3</span>       0        0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>020     4 ML     CSX    Hillsbor…  0.074<span style="text-decoration: underline;">3</span>       0        0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>020     5 ML     CSX    Hillsbor…  0.074<span style="text-decoration: underline;">3</span>       0        0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>020     6 ML     CSX    Hillsbor…  0.074<span style="text-decoration: underline;">3</span>       0        0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>020     7 ML     CSX    Hillsbor…  0.074<span style="text-decoration: underline;">3</span>       0        0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>020     8 ML     CSX    Hillsbor…  0.074<span style="text-decoration: underline;">3</span>       0        0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>020     9 ML     CSX    Hillsbor…  0.074<span style="text-decoration: underline;">3</span>       0        0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>020    10 ML     CSX    Hillsbor…  0.074<span style="text-decoration: underline;">3</span>       0        0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 50 more rows</span></span></span>
<span></span>
<span><span class="co"># combine by bay segment and year</span></span>
<span><span class="fu"><a href="../reference/anlz_ml.html">anlz_ml</a></span><span class="op">(</span><span class="va">mlfls</span>, summ <span class="op">=</span> <span class="st">"segment"</span>, summtime <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 8</span></span></span>
<span><span class="co">#&gt;    Year source segment          tn_load tp_load tss_load bod_load hy_load</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>017 ML     Hillsborough Bay  0.186        0        0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>018 ML     Hillsborough Bay  0.188        0        0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">2</span>019 ML     Hillsborough Bay  0.022<span style="text-decoration: underline;">4</span>       0        0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">2</span>020 ML     Hillsborough Bay  0.892        0        0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">2</span>021 ML     Hillsborough Bay  0.989        0        0        0       0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ad">AD<a class="anchor" aria-label="anchor" href="#ad"></a>
</h3>
<p>Loading from atmospheric deposition (AD) for bay segments in the
Tampa Bay watershed are calculated using rainfall data from weather
stations in the watershed and atmospheric concentration data from the
Verna Wellfield site. Rainfall data must be obtained using the
<code><a href="../reference/util_getrain.html">util_getrain()</a></code> function before calculating loads. For
convenience, daily rainfall data from 2017 to 2023 at sites in the
watershed are included with the package in the <code>rain</code>
object.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rain</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;   station date        Year Month   Day rainfall</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     228 2017-01-01  <span style="text-decoration: underline;">2</span>017     1     1     0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     228 2017-01-02  <span style="text-decoration: underline;">2</span>017     1     2     0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     228 2017-01-03  <span style="text-decoration: underline;">2</span>017     1     3     0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     228 2017-01-04  <span style="text-decoration: underline;">2</span>017     1     4     0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     228 2017-01-05  <span style="text-decoration: underline;">2</span>017     1     5     0.02</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     228 2017-01-06  <span style="text-decoration: underline;">2</span>017     1     6     0</span></span></code></pre></div>
<p>The Verna Wellfield data must also be obtained from <a href="https://nadp.slh.wisc.edu/sites/ntn-FL41/" class="external-link uri">https://nadp.slh.wisc.edu/sites/ntn-FL41/</a> as monthly
observations. This file is also included with the package and can be
found using <code><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file()</a></code> as follows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vernafl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/verna-raw.csv'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span><span class="va">vernafl</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/tbeploads/extdata/verna-raw.csv"</span></span></code></pre></div>
<p>During load calculation, the Verna data are converted to total
nitrogen and total phosphorus from ammonium and nitrate concentration
data using the <code><a href="../reference/util_prepverna.html">util_prepverna()</a></code> function. Total nitrogen
and phosphorus concentrations are estimated from ammonium and nitrate
concentrations (mg/L) using the following relationships:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>N</mi><mo>=</mo><mi>N</mi><msubsup><mi>H</mi><mn>4</mn><mo>+</mo></msubsup><mo>*</mo><mn>0.78</mn><mo>+</mo><mi>N</mi><msubsup><mi>O</mi><mn>3</mn><mo>−</mo></msubsup><mo>*</mo><mn>0.23</mn></mrow><annotation encoding="application/x-tex">
TN = NH_4^+ * 0.78 + NO_3^- * 0.23
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>P</mi><mo>=</mo><mn>0.01262</mn><mo>*</mo><mi>T</mi><mi>N</mi><mo>+</mo><mn>0.00110</mn></mrow><annotation encoding="application/x-tex">
TP = 0.01262 * TN + 0.00110
</annotation></semantics></math></p>
<p>The first equation corrects for the % of ions in ammonium and nitrate
that are N, and the second is a regression relationship between TBADS TN
and TP, applied to Verna.</p>
<p>AD loads are estimated using the <code><a href="../reference/anlz_ad.html">anlz_ad()</a></code> function,
where total hydrologic load by bay segment is calculated from the rain
data and total nitrogen and phosphorus load is calculated by multiplying
hydrologic load by the atmospheric deposition concentrations from the
Verna data. Total hydrologic load for each bay segment is calculated
using daily estimates of rainfall at NWIS NCDC sites in the watershed.
This is done as a weighted mean of rainfall at the measured sites
relative to grid locations in each bay segment. The weights are based on
distance of the grid cells from the closest site as inverse distance
squared. Total hydrologic load for a sub-watershed is then estimated by
converting inches/month to m3/month using the area of each bay segment.
The distance data and bay segment areas are contained in the file
included with the package.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ad_distance</span><span class="op">)</span></span>
<span><span class="co">#&gt;   segment    seg_x   seg_y matchsit  distance     invdist2     area</span></span>
<span><span class="co">#&gt; 1       1 344902.2 3080488      520 26000.117 1.479277e-09 23407.05</span></span>
<span><span class="co">#&gt; 2       1 344902.2 3080488      940 39711.285 6.341210e-10 23407.05</span></span>
<span><span class="co">#&gt; 3       1 344902.2 3080488      945 44691.735 5.006631e-10 23407.05</span></span>
<span><span class="co">#&gt; 4       1 344902.2 3080488     1632 22105.640 2.046416e-09 23407.05</span></span>
<span><span class="co">#&gt; 5       1 344902.2 3080488     2806  8649.245 1.336730e-08 23407.05</span></span>
<span><span class="co">#&gt; 6       1 344902.2 3080488     3986 47920.032 4.354776e-10 23407.05</span></span></code></pre></div>
<p>The total nitrogen and phosphorus loads are then estimated for each
bay segment by multiplying the total hydrologic load by the total
nitrogen and phosphorus concentrations in the Verna data. The loading
calculations also include a wet/dry deposition conversion factor to
account for differences in loading during the rainy and dry seasons.</p>
<p>Using <code><a href="../reference/anlz_ad.html">anlz_ad()</a></code> to estimate AD load is done as follows,
where <code>rain</code> is the rain data and <code>vernafl</code> is the
path to the Verna Wellfield data.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlz_ad.html">anlz_ad</a></span><span class="op">(</span><span class="va">rain</span>, <span class="va">vernafl</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 672 × 7</span></span></span>
<span><span class="co">#&gt;     Year Month source segment        tn_load tp_load hy_load</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>017     1 AD     Boca Ciega Bay   0.934  0.016<span style="text-decoration: underline;">7</span>    1.98</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>017     2 AD     Boca Ciega Bay   0.945  0.016<span style="text-decoration: underline;">8</span>    1.95</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>017     3 AD     Boca Ciega Bay   0.950  0.018<span style="text-decoration: underline;">1</span>    2.48</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>017     4 AD     Boca Ciega Bay   3.03   0.047<span style="text-decoration: underline;">9</span>    3.90</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>017     5 AD     Boca Ciega Bay   9.06   0.131     6.89</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>017     6 AD     Boca Ciega Bay   9.67   0.178    22.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>017     7 AD     Boca Ciega Bay  10.8    0.189    26.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>017     8 AD     Boca Ciega Bay   5.58   0.120    24.6 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>017     9 AD     Boca Ciega Bay   2.14   0.055<span style="text-decoration: underline;">3</span>   14.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>017    10 AD     Boca Ciega Bay   1.54   0.030<span style="text-decoration: underline;">6</span>    5.56</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 662 more rows</span></span></span></code></pre></div>
<p>Results can be summarized by segment, baywide, monthly, or annually
using the <code>summ</code> and <code>summtime</code> arguments. By
default, loads are returned monthly for each segment. Note that Boca
Ciega Bay and Boca Ciega Bay South results are returned separately. Only
Boca Ciega Bay South is used when estimating total bay loads.</p>
</div>
<div class="section level3">
<h3 id="nps">NPS<a class="anchor" aria-label="anchor" href="#nps"></a>
</h3>
<p>Non-point source (NPS) estimates are obtained for gaged and ungaged
locations in the watershed, then combined for the final result. Skip to
the final sub-section to understand how to obtain all estimates
together. Separate approaches for gaged and ungaged estimates are
described first for documentation purposes.</p>
<div class="section level4">
<h4 id="gaged-locations">Gaged locations<a class="anchor" aria-label="anchor" href="#gaged-locations"></a>
</h4>
<p>Gaged estimates are obtained using the <code><a href="../reference/anlz_nps_gaged.html">anlz_nps_gaged()</a></code>
function that retrieves flow and water quality data, then combines them
to calculate TN, TP, TSS, BOD, and hydrologic loads.</p>
<p>Required external data inputs are Lake Manatee, Tampa Bypass, and
Alafia River Bell Shoals flow data. These are not available from the
USGS API and must be obtained from the contacts listed in
<code><a href="../reference/util_nps_getextflow.html">util_nps_getextflow()</a></code>. USGS flow data are obtained from an
API for stations 02299950, 02300042, 02300500, 02300700, 02301000,
02301300, 02301500, 02301750, 02303000, 02303330, 02304500, 02306647,
02307000, 02307359, and 02307498.</p>
<p>Water Quality data are obtained from the FDEP WIN database API,
tbeptools, or local files as described in <code><a href="../reference/util_nps_getwq.html">util_nps_getwq()</a></code>.
Chosen stations are ER2 and UM2 for Manatee County and station 06-06 for
Pinellas County. Environmental Protection Commission (EPC) of
Hillsborough County stations retained are 105, 113, 114, 132, 141, 138,
142, and 147. Manatee or Pinellas County data can be imported from local
files using the <code>mancopth</code> and <code>pincopth</code>
arguments, respectively. If these are not provided, the function will
attempt to retrieve data from the FDEP WIN database using
<code>read_importwqwin()</code> from tbeptools. The EPC data are
retrieved using <code>read_importepc()</code> from tbeptools.</p>
<p>The function assumes that the water quality data are in mg/L and flow
data are in cfs. Missing water quality data are filled with previous
five year averages for the end months, then linearly interpolated using
. This function will need to be updated for future load
calculations.</p>
<p>A data frame is returned with columns for basin, year, month, TN in
mg/L, TP in mg/L, TSS in mg/L, BOD in mg/L, flow in liters/month,
hydrologic load in m3/month, TN load in kg/month, TP load in kg/month,
TSS load in kg/month, and BOD load in kg/month.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># external files included with the package</span></span>
<span><span class="va">mancopth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_wq_manco.txt'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span><span class="va">pincopth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_wq_pinco.txt'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span><span class="va">lakemanpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_lakemanatee.xlsx'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span><span class="va">tampabypth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_tampabypass.xlsx'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span><span class="va">bellshlpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_bellshoals.xls'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get gaged NPS loads</span></span>
<span><span class="va">nps_gaged</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anlz_nps_gaged.html">anlz_nps_gaged</a></span><span class="op">(</span>yrrng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2021-01-01'</span>, <span class="st">'2023-12-31'</span><span class="op">)</span>, mancopth <span class="op">=</span> <span class="va">mancopth</span>,</span>
<span>                           pincopth <span class="op">=</span> <span class="va">pincopth</span>, lakemanpth <span class="op">=</span> <span class="va">lakemanpth</span>, tampabypth <span class="op">=</span> <span class="va">tampabypth</span>,</span>
<span>                           bellshlpth <span class="op">=</span> <span class="va">bellshlpth</span><span class="op">)</span></span>
<span><span class="co">#&gt; Retrieving flow data...</span></span>
<span><span class="co">#&gt;   02299950 </span></span>
<span><span class="co">#&gt;   02300042 </span></span>
<span><span class="co">#&gt;   02300500 </span></span>
<span><span class="co">#&gt;   02300700 </span></span>
<span><span class="co">#&gt;   02301000 </span></span>
<span><span class="co">#&gt;   02301300 </span></span>
<span><span class="co">#&gt;   02301500 </span></span>
<span><span class="co">#&gt;   02301750 </span></span>
<span><span class="co">#&gt;   02303000 </span></span>
<span><span class="co">#&gt;   02303330 </span></span>
<span><span class="co">#&gt;   02304500 </span></span>
<span><span class="co">#&gt;   02306647 </span></span>
<span><span class="co">#&gt;   02307000 </span></span>
<span><span class="co">#&gt;   02307359 </span></span>
<span><span class="co">#&gt;   02307498 </span></span>
<span><span class="co">#&gt; Retrieving water quality data...</span></span>
<span><span class="co">#&gt; Retrieving Manatee County data...</span></span>
<span><span class="co">#&gt; Retreiving Pinellas County data...</span></span>
<span><span class="co">#&gt; Retrieving Hillsborough County data...</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nps_gaged</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 13</span></span></span>
<span><span class="co">#&gt;   basin      yr    mo tn_mgl tp_mgl tss_mgl bod_mgl   flow h2oload tnload tpload</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 023005…  <span style="text-decoration: underline;">2</span>021     1  0.862  0.222      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span> 4.71<span style="color: #949494;">e</span>9  4.71<span style="color: #949494;">e</span>6  <span style="text-decoration: underline;">4</span>063.  <span style="text-decoration: underline;">1</span>046.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 023005…  <span style="text-decoration: underline;">2</span>021     2  1.13   0.358      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span> 9.10<span style="color: #949494;">e</span>9  9.10<span style="color: #949494;">e</span>6 <span style="text-decoration: underline;">10</span>280.  <span style="text-decoration: underline;">3</span>257.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 023005…  <span style="text-decoration: underline;">2</span>021     3  0.941  0.327      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span> 4.62<span style="color: #949494;">e</span>9  4.62<span style="color: #949494;">e</span>6  <span style="text-decoration: underline;">4</span>351.  <span style="text-decoration: underline;">1</span>512.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 023005…  <span style="text-decoration: underline;">2</span>021     4  0.964  0.44       <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span> 8.04<span style="color: #949494;">e</span>9  8.04<span style="color: #949494;">e</span>6  <span style="text-decoration: underline;">7</span>755.  <span style="text-decoration: underline;">3</span>540.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 023005…  <span style="text-decoration: underline;">2</span>021     5  0.334  0.286      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span> 2.07<span style="color: #949494;">e</span>9  2.07<span style="color: #949494;">e</span>6   692.   593.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 023005…  <span style="text-decoration: underline;">2</span>021     6  0.871  0.341      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span> 4.12<span style="color: #949494;">e</span>9  4.12<span style="color: #949494;">e</span>6  <span style="text-decoration: underline;">3</span>585.  <span style="text-decoration: underline;">1</span>403.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: tssload &lt;dbl&gt;, bodload &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ungaged-locations">Ungaged locations<a class="anchor" aria-label="anchor" href="#ungaged-locations"></a>
</h4>
<p>Ungaged (unmonitored basins) estimates are obtained using
<code><a href="../reference/anlz_nps_ungaged.html">anlz_nps_ungaged()</a></code>. The approach combines spatial land use
data, rainfall patterns, hydrologic modeling, and empirical
relationships to estimate monthly nutrient and sediment loads. The
function requires combined spatial data for bay segment, basin, entity
jurisdiction, land use data, and soils (using <code>tbbase</code>),
rainfall data (using <code>rain</code>), and flow data (obtained with
<code><a href="../reference/util_nps_getflow.html">util_nps_getflow()</a></code>).</p>
<p>The first step is updating the combined spatial data if any of the
input datasets have changed. The required inputs are land use
(<code>tblu2020</code> or <code>tblu2023</code>), soil data
(<code>tbsoil</code>), jurisdiction (<code>tbjuris</code>), and
sub-basin data (<code>tbsubshed</code>). The function
<code><a href="../reference/util_nps_tbbase.html">util_nps_tbbase()</a></code> combines these datasets into a single
spatial object that is used for ungaged load estimation using
<code><a href="../reference/util_nps_union.html">util_nps_union()</a></code>. The function requires GDAL to be
installed and accessible in the system PATH, or the path to GDAL
binaries can be provided using the <code>gdal_path</code> argument.</p>
<p>Land use and soil data can be updated using the
<code><a href="../reference/util_nps_getswfwmd.html">util_nps_getswfwmd()</a></code> function. These data are also stored
internally with the package for easy retrieval, as are the remaining
datasets.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tblu2023</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/util_nps_getswfwmd.html">util_nps_getswfwmd</a></span><span class="op">(</span><span class="st">'lulc2023'</span><span class="op">)</span></span>
<span><span class="va">tbsoil</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/util_nps_getswfwmd.html">util_nps_getswfwmd</a></span><span class="op">(</span><span class="st">'soil'</span><span class="op">)</span></span></code></pre></div>
<p>Then, the combined layer, <code>tbbase</code>, can be created (takes
an hour or two).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tbsubshed</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tbjuris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tblu2023</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tbsoil</span><span class="op">)</span></span>
<span><span class="va">tbbase</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/util_nps_tbbase.html">util_nps_tbbase</a></span><span class="op">(</span><span class="va">tbsubshed</span>, <span class="va">tbjuris</span>, <span class="va">tblu2023</span>, <span class="va">tbsoil</span>, gdal_path <span class="op">=</span> <span class="st">"C:/OSGeo4W/bin"</span>, chunk_size <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>The <code>tbbase</code> data object is also included with the package
for convenience.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbbase</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 9</span></span></span>
<span><span class="co">#&gt;   bay_seg basin    drnfeat entity     FLUCCSCODE CLUCSID IMPROVED hydgrp area_ha</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       1 02304500 LAKE    HILLSBORO…       <span style="text-decoration: underline;">1</span>100       1        1 A      0.002<span style="text-decoration: underline;">53</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       1 02304500 LAKE    HILLSBORO…       <span style="text-decoration: underline;">1</span>100       1        1 A/D    0.006<span style="text-decoration: underline;">53</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>       1 02304500 LAKE    HILLSBORO…       <span style="text-decoration: underline;">1</span>200       2        1 A      0.032<span style="text-decoration: underline;">1</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>       1 02304500 LAKE    HILLSBORO…       <span style="text-decoration: underline;">1</span>200       2        1 A/D    0.012<span style="text-decoration: underline;">6</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>       1 02304500 LAKE    HILLSBORO…       <span style="text-decoration: underline;">1</span>400       4        1 A      0.009<span style="text-decoration: underline;">69</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>       1 02304500 LAKE    HILLSBORO…       <span style="text-decoration: underline;">1</span>400       4        1 A/D    0.007<span style="text-decoration: underline;">79</span></span></span></code></pre></div>
<p>Once the required data are prepared, ungaged loads can be estimated
using <code><a href="../reference/anlz_nps_ungaged.html">anlz_nps_ungaged()</a></code>. The following describes the
general methods for how the ungaged loads are estimated in four
steps.</p>
<div class="section level5">
<h5 id="data-preparation">1. Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h5>
<p>The first step processes land use data for logistic regression
modeling and calculates inverse distance-weighted rainfall data for each
sub-basin. This ensures that each basin receives rainfall estimates that
account for spatial variability across the watershed based on the
proximity and influence of nearby rain gauges.</p>
</div>
<div class="section level5">
<h5 id="flow-estimation">2. Flow Estimation<a class="anchor" aria-label="anchor" href="#flow-estimation"></a>
</h5>
<p>A logistic regression model predicts monthly streamflow in ungaged
basins using several key variables:</p>
<ul>
<li>
<strong>Rainfall variables</strong>: Current month rainfall plus
2-month lagged rainfall to capture antecedent moisture conditions</li>
<li>
<strong>Land use percentages</strong>: Proportions of urban,
agriculture, wetlands, and forest cover within each basin</li>
<li>
<strong>Seasonal patterns</strong>: Separate treatment for wet
season (July-October) and dry season (November-June)</li>
<li>
<strong>Urban development intensity</strong>: Basins are classified
into Group A (&lt;19% urban) or Group B (≥19% urban)</li>
<li>
<strong>Hydrologic soil characteristics</strong>: Soil group
properties that influence infiltration and runoff</li>
</ul>
</div>
<div class="section level5">
<h5 id="runoff-coefficient-application">3. Runoff Coefficient Application<a class="anchor" aria-label="anchor" href="#runoff-coefficient-application"></a>
</h5>
<p>Land use and soil-specific runoff coefficients are applied to
distribute the predicted basin flows across different landscape types
within each basin.</p>
</div>
<div class="section level5">
<h5 id="load-calculation">4. Load Calculation<a class="anchor" aria-label="anchor" href="#load-calculation"></a>
</h5>
<p>Pollutant loads are estimated using Event Mean Concentrations (EMCs)
for different land use categories, calculating:</p>
<ul>
<li>Total Nitrogen (TN) loads</li>
<li>Total Phosphorus (TP) loads<br>
</li>
<li>Total Suspended Solids (TSS) loads</li>
<li>Biochemical Oxygen Demand (BOD) loads</li>
<li>Stormwater-specific loads (with different EMCs for certain
categories)</li>
</ul>
<p>The fundamental equation for pollutant load estimation is:</p>
<p><strong>Load = Flow × EMC × Unit Conversions</strong></p>
<p>Where EMCs (Event Mean Concentrations) represent the average
pollutant concentrations in stormwater runoff for different land use
types. EMCs vary by land use category (CLUCSID) based on empirical
studies of stormwater quality. Special handling is applied for water
bodies and certain wetland types (CLUCSIDs 18, 20), which are assigned
zero stormwater loads since these areas do not generate surface runoff
in the same manner as terrestrial land uses.</p>
<p>All together, the above can be implemented as follows:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># required inputs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tbbase</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rain</span><span class="op">)</span></span>
<span><span class="va">lakemanpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_lakemanatee.xlsx'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span><span class="va">tampabypth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_tampabypass.xlsx'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span><span class="va">bellshlpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_bellshoals.xls'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nps_ungaged</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anlz_nps_ungaged.html">anlz_nps_ungaged</a></span><span class="op">(</span>yrrng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2021-01-01'</span>, <span class="st">'2023-12-31'</span><span class="op">)</span>, tbbase <span class="op">=</span> <span class="va">tbbase</span>, rain <span class="op">=</span> <span class="va">rain</span>, </span>
<span>                                lakemanpth <span class="op">=</span> <span class="va">lakemanpth</span>, tampabypth <span class="op">=</span> <span class="va">tampabypth</span>, </span>
<span>                                bellshlpth <span class="op">=</span> <span class="va">bellshlpth</span><span class="op">)</span></span>
<span><span class="co">#&gt; Prepping rain data...</span></span>
<span><span class="co">#&gt; Retrieving flow data...</span></span>
<span><span class="co">#&gt;   02299950 </span></span>
<span><span class="co">#&gt;   02300042 </span></span>
<span><span class="co">#&gt;   02300500 </span></span>
<span><span class="co">#&gt;   02300700 </span></span>
<span><span class="co">#&gt;   02301000 </span></span>
<span><span class="co">#&gt;   02301300 </span></span>
<span><span class="co">#&gt;   02301500 </span></span>
<span><span class="co">#&gt;   02301750 </span></span>
<span><span class="co">#&gt;   02303000 </span></span>
<span><span class="co">#&gt;   02303330 </span></span>
<span><span class="co">#&gt;   02304500 </span></span>
<span><span class="co">#&gt;   02306647 </span></span>
<span><span class="co">#&gt;   02307000 </span></span>
<span><span class="co">#&gt;   02307359 </span></span>
<span><span class="co">#&gt;   02307498 </span></span>
<span><span class="co">#&gt; Estimating NPS ungaged...</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nps_ungaged</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 15</span></span></span>
<span><span class="co">#&gt;   bay_seg basin       yr    mo clucsid h2oload tnload tpload tssload stnload</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       1 02304500    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      0     0     0         0      0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       1 02306647  <span style="text-decoration: underline;">2</span>021     1       1   <span style="text-decoration: underline;">7</span>661.   14.6   2.40    137.    14.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>       1 02306647  <span style="text-decoration: underline;">2</span>021     1       2  <span style="text-decoration: underline;">59</span>344.  133.   20.2    <span style="text-decoration: underline;">2</span>156.   133. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>       1 02306647  <span style="text-decoration: underline;">2</span>021     1       3 <span style="text-decoration: underline;">108</span>271.  225.   39.9    <span style="text-decoration: underline;">6</span>912.   225. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>       1 02306647  <span style="text-decoration: underline;">2</span>021     1       4  <span style="text-decoration: underline;">81</span>852.  159.   22.9    <span style="text-decoration: underline;">6</span>766.   159. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>       1 02306647  <span style="text-decoration: underline;">2</span>021     1       5  <span style="text-decoration: underline;">58</span>995.   96.6  15.8    <span style="text-decoration: underline;">5</span>542.    96.6</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: stpload &lt;dbl&gt;, stssload &lt;dbl&gt;, bodload &lt;dbl&gt;, area &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   bas_area &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="combined-gaged-and-ungaged-loads">Combined gaged and ungaged loads<a class="anchor" aria-label="anchor" href="#combined-gaged-and-ungaged-loads"></a>
</h4>
<p>Refer to the prior sections for details on how the separate loads for
gaged and ungaged portions of the wateshed are calculated. The
<code><a href="../reference/anlz_nps.html">anlz_nps()</a></code> function described below can be used to combined
all steps. The function estimates non-point source (NPS) loads for Tampa
Bay by combining ungaged and gaged NPS loads. Ungaged loads are
estimated using rainfall, flow, event mean concentration, land use, and
soils data, while gaged loads are estimated using water quality data and
flow data. The function also incorporates atmospheric concentration data
from the Verna Wellfield site.</p>
<p>Unlike the individual gaged and ungaged functions,
<code><a href="../reference/anlz_nps.html">anlz_nps()</a></code> returns loading results in tons per month or
year depending on the summary arguments. Hydrologic load is returned as
million cubic meters per month or year.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tbbase</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rain</span><span class="op">)</span></span>
<span><span class="va">mancopth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_wq_manco.txt'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span><span class="va">pincopth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_wq_pinco.txt'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span><span class="va">lakemanpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_lakemanatee.xlsx'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span><span class="va">tampabypth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_tampabypass.xlsx'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span><span class="va">bellshlpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_bellshoals.xls'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span><span class="va">vernafl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/verna-raw.csv'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anlz_nps.html">anlz_nps</a></span><span class="op">(</span>yrrng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2021-01-01'</span>, <span class="st">'2023-12-31'</span><span class="op">)</span>, tbbase <span class="op">=</span> <span class="va">tbbase</span>, rain <span class="op">=</span> <span class="va">rain</span>, </span>
<span>                mancopth <span class="op">=</span> <span class="va">mancopth</span>, pincopth <span class="op">=</span> <span class="va">pincopth</span>, lakemanpth <span class="op">=</span> <span class="va">lakemanpth</span>, </span>
<span>                tampabypth <span class="op">=</span> <span class="va">tampabypth</span>, bellshlpth <span class="op">=</span> <span class="va">bellshlpth</span>, vernafl <span class="op">=</span> <span class="va">vernafl</span><span class="op">)</span></span>
<span><span class="co">#&gt; Retrieving flow data...</span></span>
<span><span class="co">#&gt;   02299950 </span></span>
<span><span class="co">#&gt;   02300042 </span></span>
<span><span class="co">#&gt;   02300500 </span></span>
<span><span class="co">#&gt;   02300700 </span></span>
<span><span class="co">#&gt;   02301000 </span></span>
<span><span class="co">#&gt;   02301300 </span></span>
<span><span class="co">#&gt;   02301500 </span></span>
<span><span class="co">#&gt;   02301750 </span></span>
<span><span class="co">#&gt;   02303000 </span></span>
<span><span class="co">#&gt;   02303330 </span></span>
<span><span class="co">#&gt;   02304500 </span></span>
<span><span class="co">#&gt;   02306647 </span></span>
<span><span class="co">#&gt;   02307000 </span></span>
<span><span class="co">#&gt;   02307359 </span></span>
<span><span class="co">#&gt;   02307498 </span></span>
<span><span class="co">#&gt; Estimating ungaged NPS loads...</span></span>
<span><span class="co">#&gt; Prepping rain data...</span></span>
<span><span class="co">#&gt; Estimating NPS ungaged...</span></span>
<span><span class="co">#&gt; Estimating gaged NPS loads...</span></span>
<span><span class="co">#&gt; Retrieving water quality data...</span></span>
<span><span class="co">#&gt; Retrieving Manatee County data...</span></span>
<span><span class="co">#&gt; Retreiving Pinellas County data...</span></span>
<span><span class="co">#&gt; Retrieving Hillsborough County data...</span></span>
<span><span class="co">#&gt; Combining Verna data with NPS ungaged...</span></span>
<span><span class="co">#&gt; Combining ungaged and gaged NPS loads, estimating final...</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nps</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">#&gt;    Year Month source segment     basin tn_load tp_load tss_load bod_load hy_load</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>021     1 NPS    Boca Ciega… 207-5    2.43   0.398     80.8    14.5   1.22<span style="color: #949494;">e</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>021     2 NPS    Boca Ciega… 207-5    1.65   0.270     54.8     9.85  8.26<span style="color: #949494;">e</span>5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">2</span>021     3 NPS    Boca Ciega… 207-5    1.37   0.224     45.5     8.18  6.86<span style="color: #949494;">e</span>5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">2</span>021     4 NPS    Boca Ciega… 207-5    1.58   0.258     52.5     9.43  7.91<span style="color: #949494;">e</span>5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">2</span>021     5 NPS    Boca Ciega… 207-5    1.21   0.198     40.2     7.23  6.06<span style="color: #949494;">e</span>5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">2</span>021     6 NPS    Boca Ciega… 207-5    2.68   0.440     89.4    16.1   1.35<span style="color: #949494;">e</span>6</span></span></code></pre></div>
<p>The following functions are used internally and are provided here for
reference on the components used in the calculations:</p>
<ul>
<li>
<code><a href="../reference/anlz_nps_ungaged.html">anlz_nps_ungaged()</a></code>: Estimates ungaged NPS loads.</li>
<li>
<code><a href="../reference/anlz_nps_gaged.html">anlz_nps_gaged()</a></code>: Estimates gaged NPS loads.</li>
<li>
<code><a href="../reference/util_prepverna.html">util_prepverna()</a></code>: Prepares and fills missing data with
five-year means for the Verna Wellfield site data.</li>
<li>
<code><a href="../reference/util_nps_getflow.html">util_nps_getflow()</a></code>: Gets flow estimates for NPS gaged
and ungaged calculations.</li>
<li>
<code><a href="../reference/util_nps_getusgsflow.html">util_nps_getusgsflow()</a></code>: Gets USGS flow data for NPS
calculations, used in <code><a href="../reference/util_nps_getflow.html">util_nps_getflow()</a></code>.</li>
<li>
<code><a href="../reference/util_nps_getextflow.html">util_nps_getextflow()</a></code>: Gets external flow data and
contacts (Lake Manatee, Tampa Bypass, and Bell Shoals), used in
<code><a href="../reference/util_nps_getflow.html">util_nps_getflow()</a></code>.</li>
<li>
<code><a href="../reference/util_nps_getwq.html">util_nps_getwq()</a></code>: Gets water quality data for NPS gaged
calculations (for <code>mancopth</code>, <code>pincopth</code>, and
Hillsborough County data).</li>
<li>
<code><a href="../reference/util_getrain.html">util_getrain()</a></code>: Gets rainfall data for NPS ungaged
calculations, as provided in <code>rain</code>.</li>
<li>
<code><a href="../reference/util_nps_tbbase.html">util_nps_tbbase()</a></code>: Gets the combined spatial data layer
for NPS ungaged calculations, as provided in <code>tbbase</code>.</li>
</ul>
<p>Results can be summarized by basin, segment, baywide, monthly, or
annually using the <code>summ</code> and <code>summtime</code>
arguments. By default, loads are returned monthly for each basin. Note
that Boca Ciega Bay and Boca Ciega Bay South results are returned
separately. Only Boca Ciega Bay South is used when estimating total bay
loads.</p>
<p>Loads by land use type (using CLUCSID) can also be returned if
<code>aslu = TRUE</code>. These results only apply to ungaged loading
estimates.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">npslu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anlz_nps.html">anlz_nps</a></span><span class="op">(</span>yrrng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2021-01-01'</span>, <span class="st">'2023-12-31'</span><span class="op">)</span>, tbbase <span class="op">=</span> <span class="va">tbbase</span>, rain <span class="op">=</span> <span class="va">rain</span>, </span>
<span>                mancopth <span class="op">=</span> <span class="va">mancopth</span>, pincopth <span class="op">=</span> <span class="va">pincopth</span>, lakemanpth <span class="op">=</span> <span class="va">lakemanpth</span>, </span>
<span>                tampabypth <span class="op">=</span> <span class="va">tampabypth</span>, bellshlpth <span class="op">=</span> <span class="va">bellshlpth</span>, vernafl <span class="op">=</span> <span class="va">vernafl</span>,</span>
<span>                aslu <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Retrieving flow data...</span></span>
<span><span class="co">#&gt;   02299950 </span></span>
<span><span class="co">#&gt;   02300042 </span></span>
<span><span class="co">#&gt;   02300500 </span></span>
<span><span class="co">#&gt;   02300700 </span></span>
<span><span class="co">#&gt;   02301000 </span></span>
<span><span class="co">#&gt;   02301300 </span></span>
<span><span class="co">#&gt;   02301500 </span></span>
<span><span class="co">#&gt;   02301750 </span></span>
<span><span class="co">#&gt;   02303000 </span></span>
<span><span class="co">#&gt;   02303330 </span></span>
<span><span class="co">#&gt;   02304500 </span></span>
<span><span class="co">#&gt;   02306647 </span></span>
<span><span class="co">#&gt;   02307000 </span></span>
<span><span class="co">#&gt;   02307359 </span></span>
<span><span class="co">#&gt;   02307498 </span></span>
<span><span class="co">#&gt; Estimating ungaged NPS loads...</span></span>
<span><span class="co">#&gt; Prepping rain data...</span></span>
<span><span class="co">#&gt; Estimating NPS ungaged...</span></span>
<span><span class="co">#&gt; Combining Verna data with NPS ungaged...</span></span>
<span>                </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">npslu</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 11</span></span></span>
<span><span class="co">#&gt;    Year Month source segment       basin lu    tn_load tp_load tss_load bod_load</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>021     1 NPS    Boca Ciega B… 207-5 Barr… 7.11<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 5.73<span style="color: #949494;">e</span><span style="color: #BB0000;">-7</span> 0.000<span style="text-decoration: underline;">631</span>  8.32<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>021     2 NPS    Boca Ciega B… 207-5 Barr… 4.82<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 3.89<span style="color: #949494;">e</span><span style="color: #BB0000;">-7</span> 0.000<span style="text-decoration: underline;">428</span>  5.64<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">2</span>021     3 NPS    Boca Ciega B… 207-5 Barr… 4.00<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 3.23<span style="color: #949494;">e</span><span style="color: #BB0000;">-7</span> 0.000<span style="text-decoration: underline;">355</span>  4.68<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">2</span>021     4 NPS    Boca Ciega B… 207-5 Barr… 4.62<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 3.72<span style="color: #949494;">e</span><span style="color: #BB0000;">-7</span> 0.000<span style="text-decoration: underline;">409</span>  5.40<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">2</span>021     5 NPS    Boca Ciega B… 207-5 Barr… 3.54<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 2.85<span style="color: #949494;">e</span><span style="color: #BB0000;">-7</span> 0.000<span style="text-decoration: underline;">314</span>  4.14<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">2</span>021     6 NPS    Boca Ciega B… 207-5 Barr… 7.86<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 6.34<span style="color: #949494;">e</span><span style="color: #BB0000;">-7</span> 0.000<span style="text-decoration: underline;">698</span>  9.20<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: hy_load &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marcus Beck, Ed Sherwood, Ray Pribble.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
