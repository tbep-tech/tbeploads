<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate non-point source (NPS) loads for gaged basins — anlz_nps_gaged • tbeploads</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate non-point source (NPS) loads for gaged basins — anlz_nps_gaged"><meta name="description" content="Calculate non-point source (NPS) loads for gaged basins"><meta property="og:description" content="Calculate non-point source (NPS) loads for gaged basins"><meta property="og:image" content="https://tbep-tech.github.io/tbeploads/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tbeploads</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/tbeploads.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tbep-tech/tbeploads/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate non-point source (NPS) loads for gaged basins</h1>
      <small class="dont-index">Source: <a href="https://github.com/tbep-tech/tbeploads/blob/main/R/anlz_nps_gaged.R" class="external-link"><code>R/anlz_nps_gaged.R</code></a></small>
      <div class="d-none name"><code>anlz_nps_gaged.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate non-point source (NPS) loads for gaged basins</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">anlz_nps_gaged</span><span class="op">(</span></span>
<span>  yrrng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2021-01-01"</span>, <span class="st">"2023-12-31"</span><span class="op">)</span>,</span>
<span>  mancopth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pincopth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">lakemanpth</span>,</span>
<span>  <span class="va">tampabypth</span>,</span>
<span>  <span class="va">bellshlpth</span>,</span>
<span>  allflo <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  usgsflow <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-yrrng">yrrng<a class="anchor" aria-label="anchor" href="#arg-yrrng"></a></dt>
<dd><p>A vector of two dates in 'YYYY-MM-DD' format, specifying the date range to retrieve flow data. Default is from '2021-01-01' to '2023-12-31'.</p></dd>


<dt id="arg-mancopth">mancopth<a class="anchor" aria-label="anchor" href="#arg-mancopth"></a></dt>
<dd><p>character, path to the Manatee County water quality data file, see details</p></dd>


<dt id="arg-pincopth">pincopth<a class="anchor" aria-label="anchor" href="#arg-pincopth"></a></dt>
<dd><p>character, path to the Pinellas County water quality data file, see details</p></dd>


<dt id="arg-lakemanpth">lakemanpth<a class="anchor" aria-label="anchor" href="#arg-lakemanpth"></a></dt>
<dd><p>character, path to the file containing the Lake Manatee flow data</p></dd>


<dt id="arg-tampabypth">tampabypth<a class="anchor" aria-label="anchor" href="#arg-tampabypth"></a></dt>
<dd><p>character, path to the file containing the Tampa Bypass flow data</p></dd>


<dt id="arg-bellshlpth">bellshlpth<a class="anchor" aria-label="anchor" href="#arg-bellshlpth"></a></dt>
<dd><p>character, path to the file containing the Bell shoals data</p></dd>


<dt id="arg-allflo">allflo<a class="anchor" aria-label="anchor" href="#arg-allflo"></a></dt>
<dd><p>data frame of flow data, if already available from <code><a href="util_nps_getflow.html">util_nps_getflow</a></code>, otherwise NULL and the function will retrieve the data</p></dd>


<dt id="arg-usgsflow">usgsflow<a class="anchor" aria-label="anchor" href="#arg-usgsflow"></a></dt>
<dd><p>data frame of USGS flow data, if already available from <code><a href="util_nps_getusgsflow.html">util_nps_getusgsflow</a></code>, otherwise NULL and the function will retrieve the data. Default is NULL. Does not apply if <code>allflo</code> is provided.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical indicating whether to print verbose output</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with columns for basin, year, month, TN in mg/L, TP in mg/L, TSS in mg/L, BOD in mg/L, flow in liters/month, hydrologic load in m3/month, TN load in kg/month, TP load in kg/month, TSS load in kg/month, and BOD load in kg/month.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function uses <code><a href="util_nps_getflow.html">util_nps_getflow</a></code> to retrieve flow data and <code><a href="util_nps_getwq.html">util_nps_getwq</a></code> to retrieve water quality data. It then combines these datasets and calculates loads for TN, TP, TSS, BOD, and hydrologic load.  See the help files for each function for more details.</p>
<p>Required external data inputs are Lake Manatee, Tampa Bypass, and Alafia River Bell Shoals flow data.  These are not available from the USGS API and must be obtained from the contacts listed in <code><a href="util_nps_getextflow.html">util_nps_getextflow</a></code>.  USGS flow data are for stations 02299950, 02300042, 02300500, 02300700, 02301000, 02301300, 02301500, 02301750, 02303000, 02303330, 02304500, 02306647, 02307000, 02307359, and 02307498.  The USGS flow data are from the NWIS database as returned by <code><a href="https://rdrr.io/pkg/dataRetrieval/man/read_waterdata_daily.html" class="external-link">read_waterdata_daily</a></code>. A preprocessed USGS flow data frame can be provided using the <code>usgsflow</code> argument to avoid re-downloading the data.</p>
<p>Water Quality data are obtained from the FDEP WIN database API, tbeptools, or local files as described in <code><a href="util_nps_getwq.html">util_nps_getwq</a></code>. Chosen stations are ER2 and UM2 for Manatee County and station 06-06 for Pinellas County. Environmental Protection Commission (EPC) of Hillsborough County stations retained are 105, 113, 114, 132, 141, 138, 142, and 147. Manatee or Pinellas County data can be imported from local files using the <code>mancopth</code> and <code>pincopth</code> arguments, respectively.  If these are not provided, the function will attempt to retrieve data from the FDEP WIN database using <code>read_importwqwin</code> from tbeptools.  The EPC data are retrieved using <code>read_importepc</code> from tbeptools.</p>
<p>The function assumes that the water quality data are in mg/L and flow data are in cfs.  Missing water quality data are filled with previous five year averages for the end months, then linearly interpolated using <code><a href="util_nps_fillmiswq.html">util_nps_fillmiswq</a></code>.  This function will need to be updated for future load calculations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">usgsflow</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mancopth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_wq_manco.txt'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pincopth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_wq_pinco.txt'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lakemanpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_lakemanatee.xlsx'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tampabypth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_tampabypass.xlsx'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bellshlpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_bellshoals.xls'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">nps_gaged</span> <span class="op">&lt;-</span> <span class="fu">anlz_nps_gaged</span><span class="op">(</span></span></span>
<span class="r-in"><span>  yrrng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2021-01-01'</span>, <span class="st">'2023-12-31'</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  mancopth <span class="op">=</span> <span class="va">mancopth</span>,</span></span>
<span class="r-in"><span>  pincopth <span class="op">=</span> <span class="va">pincopth</span>, </span></span>
<span class="r-in"><span>  lakemanpth <span class="op">=</span> <span class="va">lakemanpth</span>, </span></span>
<span class="r-in"><span>  tampabypth <span class="op">=</span> <span class="va">tampabypth</span>,</span></span>
<span class="r-in"><span>  bellshlpth <span class="op">=</span> <span class="va">bellshlpth</span>, </span></span>
<span class="r-in"><span>  usgsflow <span class="op">=</span> <span class="va">usgsflow</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Retrieving flow data...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Retrieving water quality data...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating gaged NPS loads...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nps_gaged</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 13</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   basin      yr    mo tn_mgl tp_mgl tss_mgl bod_mgl   flow h2oload tnload tpload</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 023005…  <span style="text-decoration: underline;">2</span>021     1  0.862  0.222      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span> 4.71<span style="color: #949494;">e</span>9  4.71<span style="color: #949494;">e</span>6  <span style="text-decoration: underline;">4</span>063.  <span style="text-decoration: underline;">1</span>046.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 023005…  <span style="text-decoration: underline;">2</span>021     2  1.13   0.358      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span> 9.10<span style="color: #949494;">e</span>9  9.10<span style="color: #949494;">e</span>6 <span style="text-decoration: underline;">10</span>280.  <span style="text-decoration: underline;">3</span>257.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 023005…  <span style="text-decoration: underline;">2</span>021     3  0.941  0.327      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span> 4.62<span style="color: #949494;">e</span>9  4.62<span style="color: #949494;">e</span>6  <span style="text-decoration: underline;">4</span>351.  <span style="text-decoration: underline;">1</span>512.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 023005…  <span style="text-decoration: underline;">2</span>021     4  0.964  0.44       <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span> 8.04<span style="color: #949494;">e</span>9  8.04<span style="color: #949494;">e</span>6  <span style="text-decoration: underline;">7</span>755.  <span style="text-decoration: underline;">3</span>540.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 023005…  <span style="text-decoration: underline;">2</span>021     5  0.334  0.286      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span> 2.07<span style="color: #949494;">e</span>9  2.07<span style="color: #949494;">e</span>6   692.   593.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 023005…  <span style="text-decoration: underline;">2</span>021     6  0.871  0.341      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span> 4.12<span style="color: #949494;">e</span>9  4.12<span style="color: #949494;">e</span>6  <span style="text-decoration: underline;">3</span>585.  <span style="text-decoration: underline;">1</span>403.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: tssload &lt;dbl&gt;, bodload &lt;dbl&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marcus Beck, Ed Sherwood, Ray Pribble.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

