<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimated non-point source (NPS) ungaged loads — anlz_nps_ungaged • tbeploads</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimated non-point source (NPS) ungaged loads — anlz_nps_ungaged"><meta name="description" content="Estimated non-point source (NPS) ungaged loads"><meta property="og:description" content="Estimated non-point source (NPS) ungaged loads"><meta property="og:image" content="https://tbep-tech.github.io/tbeploads/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tbeploads</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/tbeploads.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tbep-tech/tbeploads/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimated non-point source (NPS) ungaged loads</h1>
      <small class="dont-index">Source: <a href="https://github.com/tbep-tech/tbeploads/blob/main/R/anlz_nps_ungaged.R" class="external-link"><code>R/anlz_nps_ungaged.R</code></a></small>
      <div class="d-none name"><code>anlz_nps_ungaged.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimated non-point source (NPS) ungaged loads</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">anlz_nps_ungaged</span><span class="op">(</span></span>
<span>  yrrng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2021-01-01"</span>, <span class="st">"2023-12-31"</span><span class="op">)</span>,</span>
<span>  <span class="va">tbbase</span>,</span>
<span>  <span class="va">rain</span>,</span>
<span>  <span class="va">lakemanpth</span>,</span>
<span>  <span class="va">tampabypth</span>,</span>
<span>  <span class="va">bellshlpth</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-yrrng">yrrng<a class="anchor" aria-label="anchor" href="#arg-yrrng"></a></dt>
<dd><p>A vector of two dates in 'YYYY-MM-DD' format, specifying the date range to retrieve flow data. Default is from '2021-01-01' to '2023-12-31'.</p></dd>


<dt id="arg-tbbase">tbbase<a class="anchor" aria-label="anchor" href="#arg-tbbase"></a></dt>
<dd><p>data frame containing polygon areas for the combined data layer of bay segment, basin, jurisdiction, land use data, and soils, see details</p></dd>


<dt id="arg-rain">rain<a class="anchor" aria-label="anchor" href="#arg-rain"></a></dt>
<dd><p>data frame of rainfall data, see details</p></dd>


<dt id="arg-lakemanpth">lakemanpth<a class="anchor" aria-label="anchor" href="#arg-lakemanpth"></a></dt>
<dd><p>character, path to the file containing the Lake Manatee flow data, see details</p></dd>


<dt id="arg-tampabypth">tampabypth<a class="anchor" aria-label="anchor" href="#arg-tampabypth"></a></dt>
<dd><p>character, path to the file containing the Tampa Bypass flow data, see details</p></dd>


<dt id="arg-bellshlpth">bellshlpth<a class="anchor" aria-label="anchor" href="#arg-bellshlpth"></a></dt>
<dd><p>character, path to the file containing the Bell shoals data, see details</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical indicating whether to print verbose output</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with monthly pollutant load estimates containing the following columns:</p><ul><li><p><code>bay_seg</code>: Bay segment identifier (1: Old Tampa Bay, 2: Hillsborough Bay, 3: Middle Tampa Bay, 4: Lower Tampa Bay, 5: Upper Boca Ciega Bay, 6: Terra Ceia Bay, 7: Manatee River, 55: Lower Boca Ciega Bay)</p></li>
<li><p><code>basin</code>: Basin identifier (USGS gage number or internal code)</p></li>
<li><p><code>yr</code>: Year</p></li>
<li><p><code>mo</code>: Month (1-12)</p></li>
<li><p><code>clucsid</code>: Consolidated Land Use Classification System ID</p></li>
<li><p><code>h2oload</code>: Water load (cubic meters)</p></li>
<li><p><code>tnload</code>: Total nitrogen load (kg)</p></li>
<li><p><code>tpload</code>: Total phosphorus load (kg)</p></li>
<li><p><code>tssload</code>: Total suspended solids load (kg)</p></li>
<li><p><code>stnload</code>: Stormwater total nitrogen load (kg)</p></li>
<li><p><code>stpload</code>: Stormwater total phosphorus load (kg)</p></li>
<li><p><code>stssload</code>: Stormwater total suspended solids load (kg)</p></li>
<li><p><code>bodload</code>: Biochemical oxygen demand load (kg)</p></li>
<li><p><code>area</code>: Land use area (hectares)</p></li>
<li><p><code>bas_area</code>: Total basin area (hectares)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function estimates pollutant loads from non-point sources in ungaged (unmonitored) basins within the Tampa Bay watershed. The approach combines spatial land use data, rainfall patterns, hydrologic modeling, and empirical relationships to estimate monthly nutrient and sediment loads.  Several steps are followed:</p>
<ol><li><p><strong>Data Preparation</strong>: Processes land use data for logistic regression modeling and calculates inverse distance-weighted rainfall data for each sub-basin.</p></li>
<li><p><strong>Flow Estimation</strong>: Uses a logistic regression model to predict monthly streamflow in ungaged basins based on:</p><ul><li><p>Current month rainfall and 2-month lagged rainfall</p></li>
<li><p>Land use percentages (urban, agriculture, wetlands, forest)</p></li>
<li><p>Seasonal patterns (wet season: July-October, dry season: November-June)</p></li>
<li><p>Urban development intensity (Group A: &lt;19% urban, Group B: ≥19% urban)</p></li>
<li><p>Hydrologic soil group characteristics</p></li>
</ul></li>
<li><p><strong>Runoff Coefficient Application</strong>: Applies land use and soil-specific runoff coefficients to distribute predicted flows across different landscape types within each basin.</p></li>
<li><p><strong>Load Calculation</strong>: Estimates pollutant loads using Event Mean Concentrations (EMCs) for different land use categories (CLUCSID), calculating:</p><ul><li><p>Total Nitrogen (TN) loads</p></li>
<li><p>Total Phosphorus (TP) loads</p></li>
<li><p>Total Suspended Solids (TSS) loads</p></li>
<li><p>Biochemical Oxygen Demand (BOD) loads</p></li>
<li><p>Stormwater-specific loads (with different EMCs for certain categories)</p></li>
</ul></li>
</ol><p><strong>Spatial Framework:</strong></p>
<p>The analysis uses a nested spatial hierarchy:</p><ul><li><p><strong>Bay Segments</strong>: Major subdivisions of Tampa Bay (1-7, with 55 for Lower Boca Ciega Bay)</p></li>
<li><p><strong>Basins</strong>: Hydrologic sub-basins, including both USGS gaged and ungaged areas</p></li>
<li><p><strong>Land Use Polygons</strong>: Detailed spatial units combining jurisdiction, land use (FLUCCS codes), and soil characteristics</p></li>
</ul><p><strong>Flow Prediction Models:</strong></p>
<p>The function uses season- and development-specific regression equations:</p><ul><li><p>Separate models for wet vs. dry seasons</p></li>
<li><p>Separate models for low-development (Group A) vs. high-development (Group B) areas</p></li>
<li><p>Models account for antecedent moisture conditions through lagged rainfall terms</p></li>
</ul><p><strong>Load Estimation:</strong></p>
<p>Pollutant loads are calculated as: <code>Load = Flow × EMC × Unit Conversions</code></p>
<p>Where EMCs vary by land use category (CLUCSID).  Special handling is applied for water bodies and certain wetland types (CLUCSIDs 18, 20), which are assigned zero stormwater loads.</p>
<p>Requires the following inputs:</p>
<ul><li><p><code>tbbase</code>: A data frame containing polygon areas for the combined data layer of bay segment, basin, jurisdiction, land use data, and soils, Stored as <code><a href="tbbase.html">tbbase</a></code> or created (takes an hour or so) with <code><a href="util_nps_tbbase.html">util_nps_tbbase</a></code>.</p></li>
<li><p><code>rain</code>: A data frame of rainfall data. See <code><a href="rain.html">rain</a></code>.</p></li>
<li><p><code>lakemanpth</code>: character, path to the file containing the Lake Manatee flow data. See <code><a href="util_nps_getextflow.html">util_nps_getextflow</a></code>.</p></li>
<li><p><code>tampabypth</code>: character, path to the file containing the Tampa Bypass flow data. See <code><a href="util_nps_getextflow.html">util_nps_getextflow</a></code>.</p></li>
<li><p><code>bellshlpth</code>: character, path to the file containing the Bell shoals data. See <code><a href="util_nps_getextflow.html">util_nps_getextflow</a></code>.</p></li>
</ul><p>USGS gaged flows are also used, as returned by <code><a href="util_nps_getusgsflow.html">util_nps_getusgsflow</a></code> and combined with the external flow data using <code><a href="util_nps_getextflow.html">util_nps_getextflow</a></code> and <code><a href="util_nps_getflow.html">util_nps_getflow</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># external flow sources</span></span></span>
<span class="r-in"><span><span class="va">lakemanpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_lakemanatee.xlsx'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tampabypth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_tampabypass.xlsx'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bellshlpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_bellshoals.xls'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">anlz_nps_ungaged</span><span class="op">(</span>yrrng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2021-01-01'</span>, <span class="st">'2023-12-31'</span><span class="op">)</span>, <span class="va">tbbase</span>,</span></span>
<span class="r-in"><span>   <span class="va">rain</span>, <span class="va">lakemanpth</span>, <span class="va">tampabypth</span>, <span class="va">bellshlpth</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marcus Beck, Ed Sherwood, Ray Pribble.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

