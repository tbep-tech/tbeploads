<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate non-point source (NPS) loads for Tampa Bay — anlz_nps • tbeploads</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate non-point source (NPS) loads for Tampa Bay — anlz_nps"><meta name="description" content="Calculate non-point source (NPS) loads for Tampa Bay"><meta property="og:description" content="Calculate non-point source (NPS) loads for Tampa Bay"><meta property="og:image" content="https://tbep-tech.github.io/tbeploads/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tbeploads</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/tbeploads.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tbep-tech/tbeploads/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate non-point source (NPS) loads for Tampa Bay</h1>
      <small class="dont-index">Source: <a href="https://github.com/tbep-tech/tbeploads/blob/main/R/anlz_nps.R" class="external-link"><code>R/anlz_nps.R</code></a></small>
      <div class="d-none name"><code>anlz_nps.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate non-point source (NPS) loads for Tampa Bay</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">anlz_nps</span><span class="op">(</span></span>
<span>  yrrng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2021-01-01"</span>, <span class="st">"2023-12-31"</span><span class="op">)</span>,</span>
<span>  <span class="va">tbbase</span>,</span>
<span>  <span class="va">rain</span>,</span>
<span>  <span class="va">mancopth</span>,</span>
<span>  <span class="va">pincopth</span>,</span>
<span>  <span class="va">lakemanpth</span>,</span>
<span>  <span class="va">tampabypth</span>,</span>
<span>  <span class="va">bellshlpth</span>,</span>
<span>  <span class="va">vernafl</span>,</span>
<span>  usgsflow <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  summ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"basin"</span>, <span class="st">"segment"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  summtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"month"</span>, <span class="st">"year"</span><span class="op">)</span>,</span>
<span>  aslu <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-yrrng">yrrng<a class="anchor" aria-label="anchor" href="#arg-yrrng"></a></dt>
<dd><p>A vector of two dates in 'YYYY-MM-DD' format, specifying the date range to retrieve flow data. Default is from '2021-01-01' to '2023-12-31'.</p></dd>


<dt id="arg-tbbase">tbbase<a class="anchor" aria-label="anchor" href="#arg-tbbase"></a></dt>
<dd><p>data frame containing polygon areas for the combined data layer of bay segment, basin, jurisdiction, land use data, and soils, see details</p></dd>


<dt id="arg-rain">rain<a class="anchor" aria-label="anchor" href="#arg-rain"></a></dt>
<dd><p>data frame of rainfall data, see details</p></dd>


<dt id="arg-mancopth">mancopth<a class="anchor" aria-label="anchor" href="#arg-mancopth"></a></dt>
<dd><p>character, path to the Manatee County water quality data file, see details</p></dd>


<dt id="arg-pincopth">pincopth<a class="anchor" aria-label="anchor" href="#arg-pincopth"></a></dt>
<dd><p>character, path to the Pinellas County water quality data file, see details</p></dd>


<dt id="arg-lakemanpth">lakemanpth<a class="anchor" aria-label="anchor" href="#arg-lakemanpth"></a></dt>
<dd><p>character, path to the file containing the Lake Manatee flow data, see details</p></dd>


<dt id="arg-tampabypth">tampabypth<a class="anchor" aria-label="anchor" href="#arg-tampabypth"></a></dt>
<dd><p>character, path to the file containing the Tampa Bypass flow data, see details</p></dd>


<dt id="arg-bellshlpth">bellshlpth<a class="anchor" aria-label="anchor" href="#arg-bellshlpth"></a></dt>
<dd><p>character, path to the file containing the Bell shoals data, see details</p></dd>


<dt id="arg-vernafl">vernafl<a class="anchor" aria-label="anchor" href="#arg-vernafl"></a></dt>
<dd><p>character vector of file path to Verna Wellfield atmospheric concentration data</p></dd>


<dt id="arg-usgsflow">usgsflow<a class="anchor" aria-label="anchor" href="#arg-usgsflow"></a></dt>
<dd><p>data frame of USGS flow data, if already available from <code><a href="util_nps_getusgsflow.html">util_nps_getusgsflow</a></code>, otherwise NULL and the function will retrieve the data. Default is NULL.</p></dd>


<dt id="arg-summ">summ<a class="anchor" aria-label="anchor" href="#arg-summ"></a></dt>
<dd><p>chr string indicating how the returned data are summarized, see details</p></dd>


<dt id="arg-summtime">summtime<a class="anchor" aria-label="anchor" href="#arg-summtime"></a></dt>
<dd><p>chr string indicating how the returned data are summarized temporally (month or year), see details</p></dd>


<dt id="arg-aslu">aslu<a class="anchor" aria-label="anchor" href="#arg-aslu"></a></dt>
<dd><p>logical indicating whether to summarize by land use type (ungaged loads only), default is FALSE</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical indicating whether to print verbose output</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame of non-point source loads for Tampa Bay, including columns for year, month, bay segment, basin, and loads for total nitrogen (TN), total phosphorus (TP), total suspended solids (TSS), biochemical oxygen demand (BOD), and hydrology using default values for the <code>summ</code> and <code>summtime</code> arguments. TN, TP, TSS, and BOD Loads are tons per month or year depending on the <code>summtime</code> argument. Hydrologic loads are cubic meters per month or year depending on the <code>summtime</code> argument.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function estimates non-point source (NPS) loads for Tampa Bay by combining ungaged and gaged NPS loads. Ungaged loads are estimated using rainfall, flow, event mean concentration, land use, and soils data, while gaged loads are estimated using water quality data and flow data. The function also incorporates atmospheric concentration data from the Verna Wellfield site.</p>
<p>The data are summarized differently based on the <code>summ</code> and <code>summtime</code> arguments.  All loading data are summed based on these arguments, e.g., by bay segment (<code>summ = 'segment'</code>) and year (<code>summtime = 'year'</code>). Options for <code>summ</code> are 'basin' to summarize across sub-basins within bay segments, 'segment' to summarize by bay segment, and 'all' to summarize total load. Loads can also be summarized by land use type with the <code>summ</code> and <code>summtime</code> argumets by setting <code>aslu = TRUE</code>.  Land use type summaries only apply to ungaged load estimates.  Options for <code>summtime</code> are 'month' to summarize by month and 'year' to summarize by year.  The default is to summarize by basin and month.</p>
<p>The following functions are used internally and are provided here for reference on the components used in the calculations:</p>
<ul><li><p><code><a href="anlz_nps_ungaged.html">anlz_nps_ungaged</a></code>: Estimates ungaged NPS loads.</p></li>
<li><p><code><a href="anlz_nps_gaged.html">anlz_nps_gaged</a></code>: Estimates gaged NPS loads.</p></li>
<li><p><code><a href="util_prepverna.html">util_prepverna</a></code>: Prepares and fills missing data with five-year means for the Verna Wellfield site data.</p></li>
<li><p><code><a href="util_nps_getflow.html">util_nps_getflow</a></code>: Gets flow estimates for NPS gaged and ungaged calculations.</p></li>
<li><p><code><a href="util_nps_getusgsflow.html">util_nps_getusgsflow</a></code>: Gets USGS flow data for NPS calculations, used in <code><a href="util_nps_getflow.html">util_nps_getflow</a></code>.</p></li>
<li><p><code><a href="util_nps_getextflow.html">util_nps_getextflow</a></code>: Gets external flow data and contacts (Lake Manatee, Tampa Bypass, and Bell Shoals), used in <code><a href="util_nps_getflow.html">util_nps_getflow</a></code>.</p></li>
<li><p><code><a href="util_nps_getwq.html">util_nps_getwq</a></code>: Gets water quality data for NPS gaged calculations (for <code>mancopth</code>, <code>pincopth</code>, and Hillsborough County data).</p></li>
<li><p><code><a href="util_getrain.html">util_getrain</a></code>: Gets rainfall data for NPS ungaged calculations, as provided in <code><a href="rain.html">rain</a></code>.</p></li>
<li><p><code><a href="util_nps_tbbase.html">util_nps_tbbase</a></code>: Gets the combined spatial data layer for NPS ungaged calculations, as provided in <code><a href="tbbase.html">tbbase</a></code>.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tbbase</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rain</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mancopth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_wq_manco.txt'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pincopth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_wq_pinco.txt'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lakemanpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_lakemanatee.xlsx'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tampabypth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_tampabypass.xlsx'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bellshlpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/nps_extflow_bellshoals.xls'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vernafl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/verna-raw.csv'</span>, package <span class="op">=</span> <span class="st">'tbeploads'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">anlz_nps</span><span class="op">(</span>yrrng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2021-01-01'</span>, <span class="st">'2023-12-31'</span><span class="op">)</span>, <span class="va">tbbase</span>, <span class="va">rain</span>, <span class="va">mancopth</span>, <span class="va">pincopth</span>,</span></span>
<span class="r-in"><span>         <span class="va">lakemanpth</span>, <span class="va">tampabypth</span>, <span class="va">bellshlpth</span>, <span class="va">vernafl</span>, <span class="va">usgsflow</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Retrieving flow data...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating ungaged NPS loads...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating gaged NPS loads...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Combining Verna data with NPS ungaged...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Combining ungaged and gaged NPS loads, estimating final...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 991 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Year Month source segment    basin tn_load tp_load tss_load bod_load hy_load</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>021     1 NPS    Boca Cieg… 207-5    2.43   0.398     80.8    14.5   1.22<span style="color: #949494;">e</span>6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>021     2 NPS    Boca Cieg… 207-5    1.65   0.270     54.8     9.85  8.26<span style="color: #949494;">e</span>5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>021     3 NPS    Boca Cieg… 207-5    1.37   0.224     45.5     8.18  6.86<span style="color: #949494;">e</span>5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>021     4 NPS    Boca Cieg… 207-5    1.58   0.258     52.5     9.43  7.91<span style="color: #949494;">e</span>5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>021     5 NPS    Boca Cieg… 207-5    1.21   0.198     40.2     7.23  6.06<span style="color: #949494;">e</span>5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>021     6 NPS    Boca Cieg… 207-5    2.68   0.440     89.4    16.1   1.35<span style="color: #949494;">e</span>6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>021     7 NPS    Boca Cieg… 207-5    9.75   1.60     318.     57.1   4.82<span style="color: #949494;">e</span>6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>021     8 NPS    Boca Cieg… 207-5   20.2    3.33     660.    119.    1.00<span style="color: #949494;">e</span>7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>021     9 NPS    Boca Cieg… 207-5   22.8    3.76     745.    134.    1.13<span style="color: #949494;">e</span>7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>021    10 NPS    Boca Cieg… 207-5    7.19   1.18     235.     42.1   3.55<span style="color: #949494;">e</span>6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 981 more rows</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marcus Beck, Ed Sherwood, Ray Pribble.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

